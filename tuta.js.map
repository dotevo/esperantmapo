{"version":3,"sources":["tuta.js"],"names":["Ujo","L","Control","extend","options","position","setText","html","controlDiv","innerHTML","onAdd","mapo","DomUtil","create","reklamteksto","Reklamujo","reklamo","setPosition","addControl","reŝargi","intervalo","setInterval","bind","$","on","fermi","clearInterval","removeControl","i18next","use","i18nextXHRBackend","escapeHtml","objekto","replace","undefined","JSON","stringify","traduki","teksto","opcioj","datumoj","Tradukilo","ĉi","get","lingvoj","linio","split","n","length","x","init","debug","lng","ns","defaultNS","fallbackLng","saveMissing","backend","loadPath","addPath","i18nextPretas","language","tradukiLeaflet","tradukiPaĝon","jqueryI18next","document","trigger","each","index","attr","t","parse","console","log","lingvo","changeLanguage","err","tradukilo","mobile","ajaxEnabled","hashListeningEnabled","pushStateEnabled","SkaliEnhavon","window","invalidateSize","scroll","enhavo","getScreenHeight","outerHeight","height","evento","select","opt","append","akiriLingvon","selected","find","selectmenu","value","ŝanĝiLingvon","map","setView","osmUrl","osm","TileLayer","maxZoom","attribution","addLayer","whenReady"],"mappings":"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","file":"tuta.js","sourcesContent":["var Ujo =  L.Control.extend({options: {position: 'bottomleft'},\n\tsetText: function(html) {\n\t\tthis.controlDiv.innerHTML = html\n\t},\n\tonAdd: function (mapo) {\n\t\tthis.controlDiv = L.DomUtil.create('div', 'leaflet-control-fenestro leaflet-control-mesaĝo')\n\t\treturn this.controlDiv\n\t}\n})\n\n/**\n * @requires ./leaflet-ujo.js\n */\nconst reklamteksto = '<a class=\"reklamujo-fermbutono\">X</a><br/><iframe scrolling=\"no\" ' +\n\t'style=\"border: 0; width: 120px; height: 240px;\" ' +\n\t'src=\"http://coinurl.com/get.php?id=59251&search=esperanto,language\"></iframe><br/>' +\n\t'<a class=\"reklamujo-fermbutono\">X</a>'\n\nclass Reklamujo {\n\tconstructor(mapo) {\n\t\tthis.mapo = mapo\n\t\tthis.reklamo = new Ujo()\n\t\tthis.reklamo.setPosition('bottomright')\n\t\tmapo.addControl(this.reklamo)\n\t\tthis.reŝargi()\n\t\tthis.intervalo = setInterval(this.reŝargi.bind(this), 1000 * 60 * 15)\n\t}\n\n\treŝargi() {\n\t\tthis.reklamo.setText(reklamteksto)\n\t\t$('.reklamujo-fermbutono').on('click', this.fermi.bind(this))\n\t}\n\n\tfermi() {\n\t\tclearInterval(this.intervalo);\n\t\tthis.mapo.removeControl(this.reklamo)\n\t}\n}\n\ni18next.use(i18nextXHRBackend)\n\nfunction escapeHtml(objekto) {\n\tif (objekto.replace === undefined) {\n\t\tobjekto = JSON.stringify(objekto)\n\t}\n\treturn objekto\n\t\t.replace(/&/g, '&amp;')\n\t\t.replace(/</g, '&lt;')\n\t\t.replace(/>/g, '&gt;')\n\t\t.replace(/\"/g, '&quot;')\n\t\t.replace(/'/g, '&#039;')\n}\n\nfunction traduki(teksto, opcioj) {\n\tlet datumoj = ''\n\tif (opcioj !== undefined) {\n\t\tdatumoj = ' data-i18n-opcioj=\"' + escapeHtml(opcioj) + '\"'\n\t}\n\treturn '<span data-i18n=\"' + teksto + '\" ' + datumoj + '>' + '</span>'\n}\n\nclass Tradukilo {\n\tconstructor() {\n\t\tlet ĉi = this\n\t\t$.get('internaciigo/lingvoj.txt', function(datumoj) {\n\t\t\tlet lingvoj = {}\n\t\t\tlet linio = datumoj.split(/\\n/)\n\t\t\tfor (var n = 0 ; n < linio.length ; ++n) {\n\t\t\t\tif (linio[n].length > 0) {\n\t\t\t\t\tlet x = linio[n].split(':')\n\t\t\t\t\tlingvoj[x[0]] = x[1]\n\t\t\t\t}\n\t\t\t}\n\t\t\tĉi.lingvoj = lingvoj\n\n\t\t\t//I18NEXT\n\t\t\ti18next.init({\n\t\t\t\tdebug: true,\n\t\t\t\tlng: 'eo',\n\t\t\t\tns: ['traduko', 'leaflet'],\n\t\t\t\tdefaultNS: 'traduko',\n\t\t\t\tfallbackLng: 'eo',\n\t\t\t\tsaveMissing: true,\n\t\t\t\tbackend: {\n\t\t\t\t\tloadPath: 'internaciigo/{{lng}}/{{ns}}.json',\n\t\t\t\t\taddPath: 'internaciigo/{{lng}}/{{ns}}.json'\n\t\t\t\t}\n\t\t\t}, ĉi.i18nextPretas.bind(ĉi))\n\t\t})\n\t}\n\n\takiriLingvon() {\n\t\treturn i18next.language\n\t}\n\n\ti18nextPretas() {\n\t\tlet ĉi = this\n\t\tthis.tradukiLeaflet()\n\t\tthis.tradukiPaĝon()\n\t\ti18next.on('languageChanged', function(lng) {\n\t\t})\n\t\tjqueryI18next.init(i18next, $)\n\t\t$(document).trigger('i18nextPretas', ĉi.lingvoj)\n\t}\n\n\ttradukiLeaflet() {\n\t\t$('#mapo [title]').each(function(index) {\n\t\t\t$(this).attr('title', i18next.t($(this).attr('aria-label'), {ns: 'leaflet'}))\n\t\t})\n\t}\n\n\ttradukiPaĝon() {\n\t\t$('[data-i18n]').each(function(index) {\n\t\t\tlet teksto = $(this).attr('data-i18n-opcioj')\n\n\t\t\tlet opcioj = ''\n\t\t\tif (teksto !== undefined) {\n\t\t\t\topcioj = JSON.parse(teksto)\n\t\t\t}\n\t\t\tconsole.log(opcioj)\n\t\t\t$(this).html(i18next.t($(this).attr('data-i18n'), opcioj))\n\t\t})\n\t}\n\n\tŝanĝiLingvon(lingvo) {\n\t\tconst ĉi = this\n\t\ti18next.changeLanguage(lingvo, (err, t) => {\n\t\t\tĉi.tradukiLeaflet()\n\t\t\tĉi.tradukiPaĝon()\n\t\t})\n\t}\n}\n\nconst tradukilo = new Tradukilo()\n\n/**\n * @requires ./tradukilo.js\n */\n\n$(document).bind('mobileinit', function() {\n\t$.mobile.ajaxEnabled = false\n\t$.mobile.hashListeningEnabled = false\n\t$.mobile.pushStateEnabled = false\n})\n\n$(document).on('pagecontainershow', function() {\n\tSkaliEnhavon()\n\t$(window).on('resize orientationchange', function() {\n\t\tSkaliEnhavon()\n\t})\n\tmapo.invalidateSize();\n})\n\nfunction SkaliEnhavon() {\n\tscroll(0, 0);\n\tvar enhavo = $.mobile.getScreenHeight() - $('.ui-paĝokapo').outerHeight() -\n\t\t$('.ui-paĝopiedo').outerHeight() - $('.ui-enhavo').outerHeight() +\n\t\t$('.ui-enhavo').height()\n\t$('.ui-enhavo').height(enhavo)\n}\n\n$(document).on('i18nextPretas', function(evento, lingvoj) {\n\tvar select = $('#lingvoj')\n\tfor (const lingvo in lingvoj) {\n\t\tconst opt = '<option class=\"lingvo\" id=\"' + lingvo +\n\t\t\t'\" value=\"' + lingvo + '\">' + lingvoj[lingvo] + '</option>'\n\t\tselect.append(opt)\n\t}\n\tconsole.log(tradukilo.akiriLingvon())\n\tvar selected = select.find('#' + tradukilo.akiriLingvon())\n\tselected.attr('selected', 'selected')\n\tselect.selectmenu();\n\tselect.selectmenu('refresh', true);\n\tselect.on('change', function () {\n\t\tvar lingvo = this.value;\n\t\ttradukilo.ŝanĝiLingvon(lingvo)\n\t})\n})\n\nlet mapo;\n\n/**\n * @requires ./tradukilo.js\n * @requires ./ui.js\n * @requires ./leaflet-reklamujo.js\n */\n\n$(document).bind('pageinit', function() {\n\tmapo = L.map('mapo').setView([51.505, -0.09], 13)\n\tconst osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'\n\tconst teksto = traduki('Datumoj de la mapo {{link}} kontribuantoj',\n\t\t{\n\t\t\t'link' : '<a href=\"http://openstreetmap.org\">OpenStreetMap</a>',\n\t\t\t'interpolation': {'escapeValue': false}\n\t\t})\n\tconst osm = new L.TileLayer(osmUrl, {maxZoom: 19, attribution: teksto})\n\tmapo.addLayer(osm)\n\tnew Reklamujo(mapo)\n\n\tmapo.whenReady(function() {\n\t})\n})\n"]}